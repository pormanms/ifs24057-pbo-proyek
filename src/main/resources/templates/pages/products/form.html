<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layouts/base :: layout(~{::title}, ~{::section}, ~{::script})}">
<head>
    <title>Form Produk</title>
</head>
<body>
<section>
    <div class="container py-4"> <!-- Tambah padding y agar tidak mepet -->
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xl-7">
                <div class="card shadow-lg border-0 rounded-4">
                    <div class="card-header bg-white py-4 border-0 text-center">
                        <h4 class="fw-bold text-dark mb-0" 
                            th:text="${productId != null} ? 'Edit Produk' : 'Tambah Produk Baru'">Form</h4>
                    </div>
                    
                    <div class="card-body p-4 p-md-5 pt-2">
                        <form th:action="${productId != null} ? @{/products/update/{id}(id=${productId})} : @{/products/save}" 
                              th:object="${productForm}" method="post" enctype="multipart/form-data">

                            <!-- 1. Nama Produk -->
                            <div class="form-floating mb-3">
                                <input type="text" th:field="*{name}" class="form-control" id="floatingName" placeholder="Nama"
                                       th:classappend="${#fields.hasErrors('name')} ? 'is-invalid'">
                                <label for="floatingName">Nama Produk</label>
                                <div class="invalid-feedback" th:errors="*{name}"></div>
                            </div>

                            <!-- 2. Kategori -->
                            <div class="form-floating mb-3">
                                <select th:field="*{category}" class="form-select" id="floatingCat">
                                    <option value="Elektronik">Elektronik</option>
                                    <option value="Pakaian">Pakaian</option>
                                    <option value="Makanan">Makanan</option>
                                    <option value="Minuman">Minuman</option>
                                    <option value="Aksesoris">Aksesoris</option>
                                    <option value="Lainnya">Lainnya</option>
                                </select>
                                <label for="floatingCat">Kategori</label>
                            </div>

                            <!-- 3. Harga & Stok -->
                            <div class="row g-3 mb-3">
                                <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">Harga (Rp)</label>
                                    <div class="input-group">
                                        <span class="input-group-text border-end-0 bg-light">Rp</span>
                                        <input type="number" th:field="*{price}" class="form-control border-start-0 ps-0" 
                                               th:classappend="${#fields.hasErrors('price')} ? 'is-invalid'">
                                    </div>
                                    <div class="text-danger small mt-1" th:errors="*{price}"></div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">Stok Awal</label>
                                    <input type="number" th:field="*{stock}" class="form-control" 
                                           th:classappend="${#fields.hasErrors('stock')} ? 'is-invalid'">
                                    <div class="text-danger small mt-1" th:errors="*{stock}"></div>
                                </div>
                            </div>

                            <!-- 4. DESKRIPSI (BARU DITAMBAHKAN) -->
                            <div class="form-floating mb-4">
                                <textarea class="form-control" placeholder="Deskripsi produk" id="floatingDesc" 
                                          th:field="*{description}" style="height: 120px"></textarea>
                                <label for="floatingDesc">Deskripsi Produk (Opsional)</label>
                            </div>

                            <!-- 5. Gambar -->
                            <div class="mb-4 bg-light p-3 rounded border border-dashed text-center">
                                <div th:if="${currentImage != null}" class="mb-3">
                                    <img th:src="@{'/uploads/' + ${currentImage}}" class="rounded shadow-sm" style="height: 80px;">
                                    <div class="small text-muted mt-1">Gambar saat ini</div>
                                </div>
                                <label class="form-label small fw-bold">Upload Gambar Produk</label>
                                <input type="file" name="imageFile" class="form-control form-control-sm mx-auto" style="max-width: 80%;" accept="image/*">
                            </div>

                            <hr class="opacity-10 my-4">

                            <!-- Tombol Aksi -->
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <a th:href="@{/products}" class="btn btn-light text-muted fw-bold px-4">Batal</a>
                                <button type="submit" class="btn btn-primary fw-bold px-5 rounded-pill shadow-sm">Simpan Data</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script></script>
</body>
</html>